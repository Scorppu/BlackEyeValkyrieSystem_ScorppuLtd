<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/main}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Profile - BlackEyeValkyrieSystem</title>
    
    <th:block layout:fragment="head">
        <style>
            .main-container {
                display: flex;
                gap: 2rem;
                max-width: 1200px;
                margin: 0 auto;
            }
            
            .credentials-sidebar {
                background-color: var(--secondary-bg);
                border-radius: 0.5rem;
                padding: 1.5rem;
                width: 250px;
                flex-shrink: 0;
            }
            
            .credentials-sidebar h2 {
                margin-top: 0;
                margin-bottom: 1.5rem;
                font-size: 1.25rem;
                font-weight: 600;
                color: var(--primary-text);
            }
            
            .tab-nav {
                display: flex;
                flex-direction: column;
                gap: 1rem;
            }
            
            .tab-item {
                display: flex;
                align-items: center;
                gap: 0.75rem;
                padding: 0.75rem;
                border-radius: 0.5rem;
                cursor: pointer;
                color: var(--secondary-text);
                transition: background-color 0.2s;
            }
            
            .tab-item:hover {
                background-color: rgba(138, 43, 226, 0.1);
            }
            
            .tab-item.active {
                background-color: rgba(138, 43, 226, 0.2);
                color: var(--accent-color);
            }
            
            .tab-content {
                display: none;
                margin-top: 1.5rem;
                color: var(--secondary-text);
            }
            
            .tab-content.active {
                display: block;
            }
            
            .info-container {
                background-color: var(--secondary-bg);
                border-radius: 0.5rem;
                padding: 2rem;
                flex-grow: 1;
            }
            
            .info-section {
                display: none;
            }
            
            .info-section.active {
                display: block;
            }
            
            .info-section h2 {
                margin-top: 0;
                margin-bottom: 0.5rem;
                font-size: 1.5rem;
                font-weight: 600;
                color: var(--primary-text);
            }
            
            .info-section p {
                margin-top: 0;
                margin-bottom: 2rem;
                color: var(--secondary-text);
            }
            
            .info-group {
                margin-bottom: 1.5rem;
            }
            
            .info-group label {
                display: block;
                margin-bottom: 0.5rem;
                font-weight: 500;
                color: var(--secondary-text);
            }
            
            .info-value {
                width: 100%;
                padding: 0.75rem 1rem;
                background-color: var(--primary-bg);
                border-radius: 0.5rem;
                color: var(--primary-text);
                font-size: 1rem;
                min-height: 2.5rem;
                box-sizing: border-box;
                border: 1px solid var(--border-color);
            }
            
            .allergies-table {
                width: 100%;
                border-collapse: collapse;
            }
            
            .allergies-table th, 
            .allergies-table td {
                padding: 0.75rem;
                text-align: left;
                border-bottom: 1px solid var(--border-color);
            }
            
            .allergies-table th {
                background-color: rgba(138, 43, 226, 0.1);
                font-weight: 600;
                color: var(--primary-text);
            }
            
            .allergies-table tbody tr:hover {
                background-color: rgba(138, 43, 226, 0.05);
            }
            
            .empty-allergies-row td {
                color: var(--secondary-text);
                font-style: italic;
            }
            
            .mt-3 {
                margin-top: 1rem;
            }
            
            .mb-4 {
                margin-bottom: 1.5rem;
            }
        </style>
    </th:block>
</head>
<body>
    <div layout:fragment="content">
        <div class="main-container">
            <!-- Left Column - Credentials -->
            <div class="credentials-sidebar">
                <h2>Credentials</h2>
                
                <div class="tab-nav">
                    <div class="tab-item active" data-target="personal-info-tab">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="8" cy="8" r="8" fill="#4263EB" opacity="0.1"/>
                            <circle cx="8" cy="8" r="4" fill="#4263EB"/>
                        </svg>
                        Personal Information
                    </div>
                    
                    <div class="tab-item" data-target="contact-info-tab">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M14.6667 11.28C14.6667 11.5333 14.6133 11.7933 14.5 12.04C14.3867 12.2867 14.2333 12.52 14.0333 12.7333C13.6933 13.0867 13.3133 13.3333 12.8867 13.48C12.4667 13.6267 12.0133 13.7067 11.5333 13.7067C10.8133 13.7067 10.0533 13.5467 9.26667 13.2267C8.48 12.9067 7.69333 12.4667 6.90667 11.9067C6.12 11.3467 5.37333 10.7267 4.66667 10.0467C3.96 9.36667 3.32 8.63333 2.74667 7.84667C2.17333 7.06 1.72 6.27333 1.4 5.48667C1.08 4.7 0.926667 3.94 0.926667 3.21333C0.926667 2.74667 1 2.30667 1.14667 1.88667C1.29333 1.46 1.53333 1.06667 1.88 0.72C2.3 0.293333 2.75333 0.08 3.22667 0.08C3.40667 0.08 3.58667 0.12 3.75333 0.2C3.92 0.28 4.07333 0.4 4.2 0.573333L5.88 2.92C6.00667 3.09333 6.1 3.24667 6.16667 3.4C6.23333 3.55333 6.26667 3.70667 6.26667 3.85333C6.26667 4.04 6.22 4.22667 6.12667 4.40667C6.03333 4.58667 5.90667 4.77333 5.74667 4.96L5.14667 5.6C5.07333 5.67333 5.04 5.76 5.04 5.86667C5.04 5.92 5.04667 5.97333 5.06 6.02667C5.07333 6.08 5.08667 6.12 5.09333 6.16C5.21333 6.40667 5.42667 6.71333 5.73333 7.08C6.04 7.44667 6.36667 7.82 6.72 8.18C7.08 8.54 7.44667 8.87333 7.82 9.18C8.19333 9.48667 8.5 9.7 8.74667 9.82C8.78667 9.82667 8.82667 9.84 8.88 9.85333C8.93333 9.86667 8.98667 9.87333 9.04667 9.87333C9.15333 9.87333 9.24 9.83333 9.31333 9.76L9.91333 9.16667C10.1067 9 10.2933 8.87333 10.4733 8.78667C10.6533 8.69333 10.84 8.64667 11.0333 8.64667C11.18 8.64667 11.3333 8.67333 11.4933 8.74C11.6533 8.80667 11.8067 8.9 11.98 9.02667L14.36 10.7333C14.5333 10.86 14.6533 11.0067 14.7267 11.1733C14.7933 11.34 14.6667 11.5133 14.6667 11.28Z" stroke="currentColor" stroke-width="1.33333" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Contact Information
                    </div>
                </div>
                
            </div>
            
            <!-- Right Column - Information Display -->
            <div class="info-container" id="info-content-container">
                <!-- Personal Information Display -->
                <div id="personal-info-section" class="info-section active">
                    <h2>Personal Information</h2>
                    <p>Patient's personal information details</p>
                    
                    <div class="info-group">
                        <label>First name</label>
                        <div class="info-value" id="firstName"></div>
                    </div>
                    
                    <div class="info-group">
                        <label>Last name</label>
                        <div class="info-value" id="lastName"></div>
                    </div>
                    
                    <div class="info-group">
                        <label>Sex</label>
                        <div class="info-value" id="sex"></div>
                    </div>
                    
                    <div class="info-group">
                        <label>Relative Name</label>
                        <div class="info-value" id="relativeName"></div>
                    </div>
                    
                    <div class="info-group">
                        <label>Date Of Birth</label>
                        <div class="info-value" id="dateOfBirth"></div>
                    </div>
                    
                    <div class="info-group">
                        <label>Age</label>
                        <div class="info-value" id="age"></div>
                    </div>
                    
                    <div class="info-group">
                        <label>Marital Status</label>
                        <div class="info-value" id="maritalStatus"></div>
                    </div>
                    
                    <div class="info-group">
                        <label>Blood Type</label>
                        <div class="info-value" id="bloodType"></div>
                    </div>

                    <!-- Drug Allergies -->
                    <div class="info-group mb-4">
                        <label>Drug Allergies</label>
                        <div class="allergies-list-container mt-3">
                            <table class="allergies-table">
                                <thead>
                                    <tr>
                                        <th>Drug Name</th>
                                    </tr>
                                </thead>
                                <tbody id="allergiesList">
                                    <tr class="empty-allergies-row">
                                        <td>No drug allergies recorded</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Contact Information Display -->
                <div id="contact-info-section" class="info-section">
                    <h2>Contact Information</h2>
                    <p>Patient's contact information details</p>
                    
                    <div class="info-group">
                        <label>Phone / Mobile</label>
                        <div class="info-value" id="contactNumber"></div>
                    </div>
                    
                    <div class="info-group">
                        <label>Email Address</label>
                        <div class="info-value" id="email"></div>
                    </div>
                    
                    <div class="info-group">
                        <label>Address 1</label>
                        <div class="info-value" id="address1"></div>
                    </div>
                    
                    <div class="info-group">
                        <label>Address 2</label>
                        <div class="info-value" id="address2"></div>
                    </div>
                    
                    <div class="info-group">
                        <label>Address 3</label>
                        <div class="info-value" id="address3"></div>
                    </div>
                    
                    <div class="info-group">
                        <label>Country</label>
                        <div class="info-value" id="country"></div>
                    </div>
                    
                    <div class="info-group">
                        <label>State</label>
                        <div class="info-value" id="state"></div>
                    </div>
                    
                    <div class="info-group">
                        <label>Town</label>
                        <div class="info-value" id="town"></div>
                    </div>
                    
                    <div class="info-group">
                        <label>Pin Code</label>
                        <div class="info-value" id="pinCode"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <th:block layout:fragment="scripts">
        <script th:inline="javascript">
            // Get patient data from Thymeleaf
            const patient = /*[[${patient}]]*/ {};
            const drugNamesMap = /*[[${drugNamesMap}]]*/ {};
            
            document.addEventListener('DOMContentLoaded', function() {
                // Populate personal information
                if (patient) {
                    document.getElementById('firstName').textContent = patient.firstName || '';
                    document.getElementById('lastName').textContent = patient.lastName || '';
                    document.getElementById('sex').textContent = patient.sex ? 'Male' : 'Female';
                    document.getElementById('relativeName').textContent = patient.relativeName || '';
                    document.getElementById('dateOfBirth').textContent = patient.dateOfBirth || '';
                    document.getElementById('age').textContent = patient.age || '';
                    document.getElementById('maritalStatus').textContent = patient.maritalStatus || '';
                    document.getElementById('bloodType').textContent = patient.bloodType || '';
                    
                    // Populate contact information
                    if (patient.address) {
                        document.getElementById('contactNumber').textContent = patient.contactNumber || '';
                        document.getElementById('email').textContent = patient.email || '';
                        document.getElementById('address1').textContent = patient.address.addressLine1 || '';
                        document.getElementById('address2').textContent = patient.address.addressLine2 || '';
                        document.getElementById('address3').textContent = patient.address.addressLine3 || '';
                        document.getElementById('country').textContent = patient.address.country || '';
                        document.getElementById('state').textContent = patient.address.state || '';
                        document.getElementById('town').textContent = patient.address.town || '';
                        document.getElementById('pinCode').textContent = patient.address.pinCode || '';
                    }
                    
                    // Populate drug allergies
                    if (patient.drugAllergies && patient.drugAllergies.length > 0) {
                        const allergiesList = document.getElementById('allergiesList');
                        const emptyRow = allergiesList.querySelector('.empty-allergies-row');
                        if (emptyRow) {
                            emptyRow.remove();
                        }
                        
                        patient.drugAllergies.forEach(drugId => {
                            const drugName = drugNamesMap[drugId] || 'Unknown Drug';
                            const row = document.createElement('tr');
                            row.innerHTML = `<td>${drugName}</td>`;
                            allergiesList.appendChild(row);
                        });
                    }
                }
                
                // Tab navigation
                const tabItems = document.querySelectorAll('.tab-item');
                const personalInfoSection = document.getElementById('personal-info-section');
                const contactInfoSection = document.getElementById('contact-info-section');
                
                // Switch between sections based on tab
                function switchSection(tabId) {
                    // Hide all sections
                    document.querySelectorAll('.info-section').forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    // Show the correct section
                    if (tabId === 'personal-info-tab') {
                        personalInfoSection.classList.add('active');
                        document.querySelectorAll('.tab-item').forEach(tab => {
                            if (tab.dataset.target === 'personal-info-tab') {
                                tab.classList.add('active');
                            } else {
                                tab.classList.remove('active');
                            }
                        });
                        document.getElementById('personal-info-tab').classList.add('active');
                        document.getElementById('contact-info-tab').classList.remove('active');
                    } else if (tabId === 'contact-info-tab') {
                        contactInfoSection.classList.add('active');
                        document.querySelectorAll('.tab-item').forEach(tab => {
                            if (tab.dataset.target === 'contact-info-tab') {
                                tab.classList.add('active');
                            } else {
                                tab.classList.remove('active');
                            }
                        });
                        document.getElementById('contact-info-tab').classList.add('active');
                        document.getElementById('personal-info-tab').classList.remove('active');
                    }
                }
                
                // Tab click event handling
                tabItems.forEach(function(tab) {
                    tab.addEventListener('click', function() {
                        const targetId = this.dataset.target;
                        switchSection(targetId);
                    });
                });
            });
        </script>
    </th:block>
</body>
</html> 